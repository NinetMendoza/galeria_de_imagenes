<div class="bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition">
  <!-- Post Header -->
  <div class="flex items-center justify-between p-4 border-b border-gray-200">
    <div class="flex items-center space-x-3">
      <img
        [src]="post.user.profileImage"
        alt="{{ post.user.username }}"
        class="w-12 h-12 rounded-full object-cover border-2 border-gray-200"
      />
      <div>
        <p class="font-bold text-gray-900 hover:text-gray-700 cursor-pointer">{{ post.user.username }}</p>
        <p class="text-xs text-gray-500">
          {{ post.createdAt | date : 'short' }}
        </p>
      </div>
    </div>
    <button class="text-gray-500 hover:text-gray-700 text-xl">â‹®</button>
  </div>

  <!-- Post Image -->
  <img [src]="post.image" alt="Post" class="w-full h-96 object-cover hover:opacity-95 transition" />

  <!-- Post Actions -->
  <div class="flex items-center justify-between p-4 border-b border-gray-200">
    <div class="flex items-center space-x-1">
      <!-- Reaction Button with Picker -->
      <div class="relative">
        <button 
          (click)="toggleReactionPicker()" 
          class="flex items-center space-x-2 text-gray-600 hover:text-red-500 transition group px-3 py-2 rounded-lg hover:bg-gray-100"
        >
          <span class="text-2xl group-hover:scale-110 transition">
            <ng-container *ngIf="getUserReaction() as userReaction">
              {{ getReactionEmoji(userReaction) }}
            </ng-container>
            <ng-container *ngIf="!getUserReaction()">
              ğŸ¤
            </ng-container>
          </span>
          <span class="text-sm font-medium">{{ post.likes }}</span>
        </button>

        <!-- Reaction Picker Popup -->
        <div *ngIf="showReactionPicker" class="absolute bottom-12 left-0 bg-white border border-gray-200 rounded-full shadow-lg p-2 flex gap-2 z-20">
          <button 
            *ngFor="let type of reactionTypes"
            (click)="addReaction(type)"
            class="text-2xl hover:scale-125 transition p-1"
            [title]="type"
          >
            {{ reactionEmojis[type] }}
          </button>
        </div>
      </div>

      <!-- Comment Button -->
      <button 
        (click)="toggleComments()" 
        class="flex items-center space-x-2 text-gray-600 hover:text-blue-500 transition group px-3 py-2 rounded-lg hover:bg-gray-100"
      >
        <span class="text-2xl group-hover:scale-110 transition">ğŸ’¬</span>
        <span class="text-sm font-medium">{{ post.comments.length }}</span>
      </button>

      <!-- Share Button -->
      <button class="flex items-center space-x-2 text-gray-600 hover:text-green-500 transition group px-3 py-2 rounded-lg hover:bg-gray-100">
        <span class="text-2xl group-hover:scale-110 transition">ğŸ“¤</span>
      </button>
    </div>

    <!-- Save Button -->
    <button 
      (click)="toggleSavePost()"
      class="text-gray-600 hover:text-yellow-500 transition group px-3 py-2 rounded-lg hover:bg-gray-100"
    >
      <span class="text-2xl group-hover:scale-110 transition">{{ isSaved ? 'ğŸ”–' : 'ğŸ–‡ï¸' }}</span>
    </button>
  </div>

  <!-- Reactions Summary -->
  <div *ngIf="post.reactions && post.reactions.length > 0" class="px-4 py-2 border-b border-gray-100">
    <div class="flex gap-2 text-xs">
      <span *ngFor="let reaction of getReactionSummary()" class="inline-flex items-center gap-1">
        {{ getReactionEmoji(reaction.type) }}<span class="text-gray-600">{{ reaction.count }}</span>
      </span>
    </div>
  </div>

  <!-- Caption -->
  <div class="px-4 py-3 border-b border-gray-200">
    <p class="text-gray-900 text-sm">
      <span class="font-bold hover:underline cursor-pointer">{{ post.user.username }}</span>
      {{ post.caption }}
    </p>
  </div>

  <!-- Comments Preview -->
  <div class="px-4 py-2">
    <p 
      *ngIf="post.comments.length > 0" 
      class="text-xs text-gray-500 mb-3 hover:text-gray-700 cursor-pointer"
    >
      Ver los {{ post.comments.length }} comentario{{ post.comments.length > 1 ? 's' : '' }}
    </p>
    <div *ngIf="post.comments.length === 0" class="text-xs text-gray-400 mb-3">
      Sin comentarios aÃºn
    </div>
    <div *ngFor="let comment of post.comments.slice(0, 2)" class="mb-3">
      <p class="text-xs text-gray-900">
        <span class="font-bold hover:underline cursor-pointer">{{ comment.user.username }}</span>
        <span class="text-gray-700 ml-1">{{ comment.text }}</span>
      </p>
    </div>
  </div>

  <!-- Add Comment Input -->
  <div class="px-4 py-3 border-t border-gray-200 flex items-center space-x-2">
    <img 
      src="https://api.dicebear.com/7.x/avataaars/svg?seed=current"
      alt="Tu foto"
      class="w-8 h-8 rounded-full object-cover"
    />
    <input
      type="text"
      placeholder="AÃ±ade un comentario..."
      class="flex-1 bg-gray-100 rounded-full px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-pink-500 focus:bg-white transition"
    />
    <button class="text-pink-500 font-bold hover:text-pink-700 text-sm transition">Publicar</button>
  </div>
</div>
